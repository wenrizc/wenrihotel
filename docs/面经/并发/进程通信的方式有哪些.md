
进程通信（Inter-Process Communication, IPC）是指不同进程之间交换数据或信号的机制。常见方式包括**管道**、**消息队列**、**共享内存**、**信号量**、**信号**、**套接字 和文件**，每种方式适用于不同场景，区别在于通信效率、数据格式和使用复杂度。

---

### 1. 常见进程通信方式
#### (1) 管道（Pipe）
- **定义**：单向数据流，通常用于有亲缘关系的进程（如父子进程）。
- **类型**：
  - **匿名管道**：临时，父子进程间通信。
  - **命名管道（FIFO）**：文件系统中的管道，可用于无关进程。
- **实现**：Linux `pipe()` 或 `mkfifo()`。
- **示例**：
```c
int fd[2];
pipe(fd); // fd[0] 读，fd[1] 写
```
- **特点**：简单，单向，缓冲区有限。

#### (2) 消息队列（Message Queue）
- **定义**：进程通过队列发送和接收结构化消息，支持无关进程。
- **实现**：System V（如 `msgget()`）或 POSIX（如 `mq_open()`）。
- **示例**：
```c
int msgid = msgget(IPC_PRIVATE, 0666);
msgsnd(msgid, &msg, sizeof(msg), 0); // 发送
msgrcv(msgid, &msg, sizeof(msg), 0, 0); // 接收
```
- **特点**：异步，支持优先级，消息边界清晰。

#### (3) 共享内存（Shared Memory）
- **定义**：多个进程映射同一块内存区域，直接读写数据。
- **实现**：System V（如 `shmget()`）或 POSIX（如 `shm_open()`）。
- **示例**：
```c
int shmid = shmget(IPC_PRIVATE, 4096, 0666);
char *shm = shmat(shmid, NULL, 0); // 映射
```
- **特点**：最快，需同步机制（如信号量）。

#### (4) 信号量（Semaphore）
- **定义**：用于进程间同步，控制共享资源访问。
- **实现**：System V（如 `semget()`）或 POSIX（如 `sem_open()`）。
- **示例**：
```c
sem_t *sem = sem_open("/sem", O_CREAT, 0644, 1);
sem_wait(sem); // P 操作
sem_post(sem); // V 操作
```
- **特点**：配合共享内存使用，解决竞争。

#### (5) 信号（Signal）
- **定义**：异步通知机制，发送简单事件（如终止、中断）。
- **实现**：Linux `kill()`、`signal()`。
- **示例**：
```c
signal(SIGUSR1, handler); // 注册信号处理
kill(pid, SIGUSR1); // 发送信号
```
- **特点**：轻量，适合控制而非数据传输。

#### (6) 套接字（Socket）
- **定义**：网络通信机制，支持本地或跨主机进程通信。
- **类型**：TCP（可靠）、UDP（快速）。
- **示例**：
```java
// Java Server
ServerSocket server = new ServerSocket(8080);
Socket client = server.accept();
```
- **特点**：跨机器通用，复杂度高。

#### (7) 文件
- **定义**：通过读写文件交换数据。
- **实现**：标准文件操作（如 `fopen()`、`fwrite()`）。
- **示例**：
```c
FILE *f = fopen("data.txt", "w");
fwrite("Hello", 1, 5, f);
```
- **特点**：简单持久，速度慢。

---

### 2. 区别总结
| **方式**      | **通信类型**   | **速度** | **复杂度** | **适用场景**             |
|---------------|----------------|----------|------------|--------------------------|
| 管道          | 单向数据流     | 中等     | 低         | 父子进程通信             |
| 消息队列      | 结构化消息     | 中等     | 中等       | 异步消息传递             |
| 共享内存      | 直接内存访问   | 快       | 高         | 高性能数据共享           |
| 信号量        | 同步控制       | -        | 中等       | 配合共享内存             |
| 信号          | 事件通知       | 快       | 低         | 进程控制                 |
| 套接字        | 网络通信       | 中等     | 高         | 跨机或本地通信           |
| 文件          | 持久化数据     | 慢       | 低         | 简单持久化交换           |

---

### 3. 延伸与面试角度
- **选择依据**：
  - **管道**：简单亲缘通信。
  - **共享内存**：高性能需求。
  - **Socket**：分布式系统。
- **同步 vs 异步**：
  - 管道、共享内存：同步。
  - 消息队列、信号：异步。
- **与线程通信对比**：
  - 线程共享内存，进程需显式 IPC。
- **面试点**：
  - 问“方式”时，提 7 种并举例。
  - 问“区别”时，提速度和场景。

---

### 总结
进程通信方式包括管道、消息队列、共享内存、信号量、信号、套接字和文件，区别在通信方式、效率和复杂度。面试时，可结合代码（如 `pipe`）或场景（如 Socket 跨机），展示理解深度。
