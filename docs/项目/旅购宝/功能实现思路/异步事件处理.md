
系统采用事件驱动架构处理支付等异步业务场景，提高系统吞吐量和可靠性。

### 事件架构设计

基于Spring事件机制和RabbitMQ实现了两级事件处理：

- **本地事件**：进程内快速处理的事件
- **分布式事件**：跨服务通信的事件

### 本地事件机制

基于Spring的ApplicationEventPublisher实现进程内事件：

- **事件定义**：继承ApplicationEvent定义各类业务事件
- **事件发布**：通过eventPublisher.publishEvent()方法发布事件
- **事件监听**：使用@EventListener注解定义监听方法
- **事务绑定**：通过@TransactionalEventListener确保事务完成后处理事件

典型应用场景：订单创建后更新库存、增加积分等后续处理。

### 分布式事件机制

基于RabbitMQ实现跨服务通信的事件处理：

- **消息生产**：业务完成后发送事件消息到RabbitMQ交换机
- **消息路由**：根据事件类型路由到不同的队列
- **消息消费**：各服务订阅关心的事件并处理
- **失败处理**：实现死信队列和重试机制处理失败事件

典型应用场景：支付完成后触发发货流程、短信通知等跨服务操作。

### 事件持久化

对关键业务事件进行持久化处理：

- **事件表**：记录事件内容、状态和处理结果
- **定时扫描**：定期扫描未处理完成的事件并重试
- **幂等处理**：确保事件多次处理结果一致