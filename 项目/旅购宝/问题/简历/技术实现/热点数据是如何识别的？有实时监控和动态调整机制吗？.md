
## 热点数据识别机制

1. **访问频率统计**：
   - 系统利用Redis计数器记录每个门票的访问次数
   - 通过`TicketHeatManager`类中的`recordAccess`方法统计门票访问量
   - 当访问量达到预设阈值(`HOT_THRESHOLD`，默认为100)时，将门票标记为热门

2. **定期评估机制**：
   - 系统采用定时任务进行热度评估，每天凌晨3点执行
   - 由`TicketHeatEvaluationTask`类通过`@Scheduled`注解实现
   - 同时支持通过XXL-Job分片执行大规模评估任务

3. **分级存储**：
   - 热门门票ID存储在Redis的Set集合中，键名为`cache:hot_ticket:set`
   - 访问量统计存储在以`stats:ticket:access:`为前缀的键中

## 动态调整机制

1. **自动升级与降级**：
   - **升级机制**：当门票访问量超过阈值，自动升级为热点数据
   - **降级机制**：评估任务会对已是热门但访问量降低的门票执行降级

2. **缓存策略动态调整**：
   - 热门门票使用逻辑过期机制，普通门票使用物理过期
   - 热门门票缓存时间延长(30分钟)，普通门票较短(10分钟)
   - 热门门票数据发生变更时，异步更新避免阻塞

3. **库存预热**：
   - 热门门票的库存数据会预加载到Redis中
   - 系统启动时，`TicketPreloadRunner`会预热所有热门门票数据
   - 新加入热门的门票会立即触发数据预热

## 系统监控与反馈

1. **系统负载监控**：
   - `SystemMonitor`工具类监控CPU和内存使用情况
   - 通过定期采集指标判断系统是否过载
   - 当系统负载过高时降低预热和评估任务的执行频率

2. **性能统计**：
   - 管理员可通过`SystemController`查看系统指标和热点数据统计
   - 包括访问QPS、热点命中率等关键指标

3. **限流保护**：
   - 使用Sentinel实现接口限流，特别针对热门接口
   - 防止因热点数据访问量过大导致系统崩溃

这套机制使系统能够实时识别热点数据并动态调整资源分配策略，既保证了热门数据的访问性能，又避免了资源浪费，同时在高峰期保护系统稳定性。